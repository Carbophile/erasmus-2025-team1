-- --------------------------------------------------------
-- Host:                         C:\Users\Maart\Documents\GitHub\erasmus-2025-team1\migrations.db
-- Server version:               3.44.0
-- Server OS:                    
-- HeidiSQL Version:             12.6.0.6765
-- --------------------------------------------------------

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET NAMES  */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

-- Dumping structure for table migrations.quizes
CREATE TABLE IF NOT EXISTS "quizes" (
	"id" INTEGER NOT NULL,
	"score_needed" INTEGER NOT NULL,
	"name" VARCHAR(64) NOT NULL,
	"max_time" INTEGER NOT NULL,
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NULL,
	PRIMARY KEY ("id")
);

-- Dumping structure for table migrations.questions
CREATE TABLE IF NOT EXISTS "questions" (
	"id" INTEGER NOT NULL,
	"category_id" INTEGER NULL DEFAULT NULL,
	"quiz_id" INTEGER NOT NULL,
	"text" VARCHAR(256) NULL DEFAULT NULL,
	"country" TINYINT NULL,
	"difficulty" INTEGER NULL DEFAULT NULL,
	"score_multiplier" INTEGER NULL DEFAULT NULL,
	"create_date" DATETIME NULL DEFAULT NULL,
	"update_date" DATETIME NULL DEFAULT NULL,
	PRIMARY KEY ("id"),
	FOREIGN KEY ("quiz_id") REFERENCES "quizes"("id") ON DELETE CASCADE,
	FOREIGN KEY ("category_id") REFERENCES "categories"("id") ON DELETE SET NULL
);

-- Dumping structure for table migrations.options
CREATE TABLE IF NOT EXISTS "options" (
	"id" INTEGER NOT NULL,
	"question_id" INTEGER NOT NULL,
	"option" VARCHAR(64) NOT NULL DEFAULT '',
	"correct" TINYINT NOT NULL,
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NULL,
	PRIMARY KEY ("id"),
	FOREIGN KEY ("question_id") REFERENCES "questions"("id") ON DELETE CASCADE
);

-- Dumping structure for table migrations.users
CREATE TABLE IF NOT EXISTS "users" (
	"id" INTEGER NOT NULL,
	"email" VARCHAR(254) NOT NULL DEFAULT '',
	"name" VARCHAR(64) NOT NULL DEFAULT '',
	"password" VARCHAR(256) NOT NULL DEFAULT '',
	"is_admin" TINYINT NOT NULL,
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NOT NULL,
	PRIMARY KEY ("id"),
	UNIQUE("email")
);

-- Dumping structure for table migrations.categories
CREATE TABLE IF NOT EXISTS "categories" (
	"id" INTEGER NOT NULL,
	"name" VARCHAR(64) NOT NULL DEFAULT '',
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NULL,
	PRIMARY KEY ("id")
);

-- Dumping structure for table migrations.results
CREATE TABLE IF NOT EXISTS "results" (
	"id" INTEGER NOT NULL,
	"user_id" INTEGER NOT NULL,
	"quiz_id" INTEGER NOT NULL,
	"score" INTEGER NOT NULL,
	"time_taken" INTEGER NOT NULL,
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NULL,
	PRIMARY KEY ("id"),
	FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE,
	FOREIGN KEY ("quiz_id") REFERENCES "quizes"("id")  ON DELETE SET NULL
);

-- Dumping structure for table migrations.results
CREATE TABLE IF NOT EXISTS "sessions" (
	"id" INTEGER NOT NULL,
	"user_id" INTEGER NOT NULL,
	"token" varchar(640) NOT NULL,
	"expires_at" DATETIME NOT NULL,
	"create_date" DATETIME NOT NULL,
	"update_date" DATETIME NULL,
	PRIMARY KEY ("id"),
	FOREIGN KEY ("user_id") REFERENCES "users"("id") ON DELETE CASCADE
);

-- Re-enable settings
/*!40103 SET TIME_ZONE=IFNULL(@OLD_TIME_ZONE, 'system') */;
/*!40101 SET SQL_MODE=IFNULL(@OLD_SQL_MODE, '') */;
/*!40014 SET FOREIGN_KEY_CHECKS=IFNULL(@OLD_FOREIGN_KEY_CHECKS, 1) */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40111 SET SQL_NOTES=IFNULL(@OLD_SQL_NOTES, 1) */;
